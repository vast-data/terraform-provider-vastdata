---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "vastdata_tenant_client_metrics Resource - vastdata"
subcategory: ""
description: |-
  
---

# vastdata_tenant_client_metrics (Resource)



## Example Usage

```terraform
resource "vastdata_tenant_client_metrics" "vastdb_tenant_client_metrics" {
  tenant_id = 1
  config = {
    enabled            = true
    max_capacity_mb    = 1024
    retention_time_sec = 86400
    bucket_owner       = "admin"
    bucket_name        = "client-metrics-bucket"
  }
}

# ---------------------
# Complete examples
# ---------------------

data "vastdata_tenant" "vastdb_tenant" {
  name = "default"
}

resource "vastdata_tenant_client_metrics" "vastdb_tenant_client_metrics" {
  tenant_id = data.vastdata_tenant.vastdb_tenant.id

  config = {
    enabled            = true
    max_capacity_mb    = 2048
    retention_time_sec = 172800
    bucket_owner       = "metrics-user"
    bucket_name        = "vastdb-metrics"
  }

  user_defined_columns = [
    {
      name = "ENV_USER_ID"
      field = {
        column_type = "string"
      }
    },
    {
      name = "ENV_ACCESS_COUNT"
      field = {
        column_type = "int16"
      }
    }
  ]
}

# --------------------

data "vastdata_user" "vastdb_user" {
  name = "runner"
}

data "vastdata_tenant" "vastdb_tenant" {
  name = "default"
}

resource "vastdata_tenant_client_metrics" "vastdb_tenant_client_metrics" {
  tenant_id = data.vastdata_tenant.vastdb_tenant.id
  config = {
    enabled            = true
    bucket_owner       = data.vastdata_user.vastdb_user.name
    bucket_name        = "vastdb-metrics"
    max_capacity_mb    = 2048
    retention_time_sec = 172800
  }
}

# --------------------

resource "vastdata_tenant" "vastdb_tenant" {
  name             = "vastdbtenant-for-metrics"
  client_ip_ranges = [["192.168.0.11", "192.168.0.12"]]
  force_delete     = true
}

resource "vastdata_user" "vastdb_user_for_metrics" {
  name = "vastdb_user_for_metrics"
  uid  = 997160
}

resource "vastdata_view_policy" "vastdb_view_policy_for_metrics" {
  name                 = "vastdb_view_policy_for_metrics"
  tenant_id            = vastdata_tenant.vastdb_tenant.id
  flavor               = "S3_NATIVE"
  is_s3_default_policy = true
}

resource "vastdata_tenant_client_metrics" "client_metrics1" {
  depends_on = [vastdata_view_policy.vastdb_view_policy_for_metrics]
  tenant_id  = vastdata_tenant.vastdb_tenant.id
  config = {
    enabled            = true
    bucket_name        = "vastdb-metrics-dist"
    bucket_owner       = vastdata_user.vastdb_user_for_metrics.name
    max_capacity_mb    = 1024
    retention_time_sec = 86400
  }
  user_defined_columns = [
    {
      name = "ENV_USER_ID"
      field = {
        column_type = "string"
      }
    }
  ]
}

# --------------------
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `tenant_id` (Number) ID of the tenant to manage client metrics for.

### Optional

- `config` (Attributes) (see [below for nested schema](#nestedatt--config))
- `user_defined_columns` (Attributes Set) Description of table columns (see [below for nested schema](#nestedatt--user_defined_columns))

<a id="nestedatt--config"></a>
### Nested Schema for `config`

Required:

- `enabled` (Boolean) Enables collection of client metrics. If you enable the collection of client metrics, make sure bucket_owner and bucket_name are set as well.

Optional:

- `bucket_name` (String) The name of the client metrics database S3 bucket
- `bucket_owner` (String) The user designated as the S3 bucket owner for the client metrics database for the tenant.
- `max_capacity_mb` (Number) The maximum size of the client metrics database, in MBB. If the limit is reached, older data is deleted from the database.
- `retention_time_sec` (Number) The retention period, in seconds, for client metrics data that is stored in the client metrics database. Data older than this time is deleted from the database.


<a id="nestedatt--user_defined_columns"></a>
### Nested Schema for `user_defined_columns`

Required:

- `field` (Attributes) Column type (see [below for nested schema](#nestedatt--user_defined_columns--field))
- `name` (String) Name of the object

<a id="nestedatt--user_defined_columns--field"></a>
### Nested Schema for `user_defined_columns.field`

Optional:

- `column_type` (String)
- `key_type` (Attributes) Column type for the map key (only when `column_type` is "map") (see [below for nested schema](#nestedatt--user_defined_columns--field--key_type))
- `value_type` (Attributes) Column type for the map value (only when `column_type` is "map") (see [below for nested schema](#nestedatt--user_defined_columns--field--value_type))

<a id="nestedatt--user_defined_columns--field--key_type"></a>
### Nested Schema for `user_defined_columns.field.key_type`

Optional:

- `column_type` (String) The type of the key (e.g., "string", "bool")


<a id="nestedatt--user_defined_columns--field--value_type"></a>
### Nested Schema for `user_defined_columns.field.value_type`

Optional:

- `column_type` (String) The type of the value (e.g., "string", "bool")
